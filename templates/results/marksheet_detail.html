{% extends "base.html" %}
{% block title %}Marksheet — {{ ms.student_name }}{% endblock %}

{% block extra_head %}
<style>
  .kv {display:grid;grid-template-columns:160px 1fr;gap:.25rem .75rem}
  .kv div{padding:.15rem 0}
  .badge-soft{background:#f6f8fa;border:1px solid #e5e7eb}
  .t td,.t th{vertical-align:middle}
  .t th{background:#f6f8fa}
  .text-end{text-align:right}
</style>
{% endblock %}

{% block content %}
<section class="container-xxl py-4 py-md-5">
  <div class="d-flex justify-content-between align-items-start gap-2 mb-3">
    <h1 class="h4 mb-0">Marksheet</h1>
    <div class="d-flex gap-2">
      <a class="btn btn-outline-secondary btn-sm" href="{% url 'reportcards:marksheet_pdf' ms.id %}">
        Download PDF
      </a>
      <a class="btn btn-outline-secondary btn-sm" href="javascript:print()">Print</a>
    </div>
  </div>

  <div class="row g-3 mb-3">
    <div class="col-12 col-lg-6">
      <div class="card border-0 shadow-sm">
        <div class="card-body">
          <div class="kv">
            <div class="text-muted">Student</div><div><strong>{{ ms.student_name }}</strong></div>
            <div class="text-muted">Roll</div><div>{{ ms.roll_number|default:"—" }}</div>
            <div class="text-muted">Section</div><div>{{ ms.section|default:"—" }}</div>
            <div class="text-muted">Class</div><div>{{ ms.grade }}</div>
            <div class="text-muted">Term</div><div>{{ ms.term }}</div>
          </div>
          {% if ms.notes %}
            <div class="mt-2 small text-muted">{{ ms.notes }}</div>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="col-12 col-lg-6">
      <div class="card border-0 shadow-sm">
        <div class="card-body d-flex flex-wrap gap-2">
          <span class="badge badge-soft">Total: <strong>{{ ms.total_obtained }}</strong></span>
          <span class="badge badge-soft">Out of: <strong>{{ ms.total_out_of }}</strong></span>
          <span class="badge badge-soft">Percent: <strong>{{ ms.percent }}%</strong></span>
          {% if ms.grade_letter %}
            <span class="badge text-bg-primary">Grade: {{ ms.grade_letter }}</span>
          {% endif %}
          {% if ms.gpa %}
            <span class="badge text-bg-secondary">GPA: {{ ms.gpa }}</span>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <div class="card border-0 shadow-sm">
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table t mb-0">
          <thead>
            <tr>
              <th>Subject</th>
              <th class="text-end">Max marks</th>
              <th class="text-end">Marks obtained</th>
              <th class="text-end">%</th>
              <th class="">Grade</th>
            </tr>
          </thead>
          <tbody>
            {% for r in rows %}
              <tr>
                <td>{{ r.subject.name }}</td>
                <td class="text-end">{{ r.max_marks }}</td>
                <td class="text-end">{{ r.marks_obtained }}</td>
                <td class="text-end">{{ r.percent }}</td>
                <td>{{ r.grade_letter }}</td>
              </tr>
            {% empty %}
              <tr><td colspan="5" class="text-center text-muted py-4">No rows.</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>

</section>
{% endblock %}